import {connect} from 'react-redux';
import React, {Component, PropTypes} from 'react';

import {getRoomsForFloor} from '../selectors';
import {fetchHelpIfNeeded, showHelp, changeHelp} from '../actions/help';

import Vulnerability from '../components/Vulnerability';

class VulnerabilitySection extends Component {
  render() {
    let {rooms, onClick} = this.props;
    return (
      <div className="container-fluid">
        {rooms.map((room, i) => {
          return <Vulnerability
            room={room}
            onClick={onClick}
            key={i} />;
        })}
      </div>
    );
  }
}

function mapStateToProps(state) {
  return {
    rooms: getRoomsForFloor(state)
  }
}

function mapDispatchToProps(dispatch) {
  return {
    onClick(vulnerability) {
      dispatch(fetchHelpIfNeeded());
      dispatch(changeHelp(vulnerability));
      dispatch(showHelp());
    }
  }
}

export default connect(mapStateToProps, mapDispatchToProps)(VulnerabilitySection);
